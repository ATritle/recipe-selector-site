<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>Recipe Finder</title>
    <!-- Favicon -->
<link rel="icon" type="image/png" href="/recipe-selector-site/favicon.png">

<!-- iOS Home Screen Icon -->
<link rel="apple-touch-icon" sizes="180x180" href="/recipe-selector-site/apple-touch-icon.png">
<meta name="apple-mobile-web-app-capable" content="yes">
<meta name="apple-mobile-web-app-status-bar-style" content="default">
<meta name="apple-mobile-web-app-title" content="Recipes">
  <link rel="stylesheet" href="css/style.css">
</head>
<body>

<div class="hero">
  <h1>Select a Recipe</h1>

  <!-- Main Category -->
  <select id="mainCategory">
    <option value="">Select Category</option>
  </select>

  <!-- Sub Category -->
  <select id="subCategory" disabled>
    <option value="">Select Sub-Category</option>
  </select>
</div>

<!-- Recipe -->
<select id="recipe" disabled>
  <option value="">Select Recipe</option>
</select>
  
    <!-- Recipe Search -->
  <input
    type="search"
    id="recipeSearch"
    placeholder="Search recipes..."
    autocomplete="off"
  />

  <ul id="searchResults"></ul>


  <script>
    fetch("recipes.json")
      .then(res => res.json())
      .then(data => init(data));

    function init(data) {
      const main = document.getElementById("mainCategory");
      const sub = document.getElementById("subCategory");
      const recipe = document.getElementById("recipe");

Object.keys(data)
  .sort((a, b) => a.localeCompare(b))
  .forEach(cat => {
    main.add(new Option(cat, cat));
  });


      main.addEventListener("change", () => {
        document.getElementById("searchResults").innerHTML = "";
document.getElementById("recipeSearch").value = "";
        sub.innerHTML = "<option value=''>Select Sub-Category</option>";
        recipe.innerHTML = "<option value=''>Select Recipe</option>";
        recipe.disabled = true;
        if (!main.value) {
          sub.disabled = true;
          return;
        }

        Object.keys(data[main.value])
  .sort((a, b) => a.localeCompare(b))
  .forEach(subCat => {
    sub.add(new Option(subCat, subCat));
  });


        sub.disabled = false;
      });

      sub.addEventListener("change", () => {
        document.getElementById("searchResults").innerHTML = "";
document.getElementById("recipeSearch").value = "";
        recipe.innerHTML = "<option value=''>Select Recipe</option>";
        if (!sub.value) {
          recipe.disabled = true;
          return;
        }

       data[main.value][sub.value]
  .slice()
  .sort((a, b) => a.name.localeCompare(b.name))
  .forEach(r => {
    recipe.add(new Option(r.name, r.url));
  });


        recipe.disabled = false;
      });

recipe.addEventListener("change", () => {
  if (recipe.value) {
    window.location.href = recipe.value;
  }
});

            setupSearch(data);

    }
        function setupSearch(data) {
      const searchInput = document.getElementById("recipeSearch");
      const results = document.getElementById("searchResults");

      const allRecipes = [];

      Object.values(data).forEach(category =>
        Object.values(category).forEach(subCat =>
          subCat.forEach(recipe => allRecipes.push(recipe))
        )
      );

      searchInput.addEventListener("input", () => {
        const term = searchInput.value.toLowerCase();
        results.innerHTML = "";

        if (term.length < 2) return;

        allRecipes
          .filter(r => r.name.toLowerCase().includes(term))
          .sort((a, b) => a.name.localeCompare(b.name))
          .forEach(r => {
            const li = document.createElement("li");
            li.textContent = r.name;
            li.onclick = () => window.open(r.url, "_blank");
            results.appendChild(li);
          });
      });
    }

  </script>

</body>
</html>








